---
title: "Proposed Workflow"
author: "Ben Thompson, Cody Coppage"
date: "2025-11-06"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Literature Review

Urban areas across the globe are warming. Cities trap heat, reduce cold-air drainage, and generally create hotter microclimates than surrounding rural areas, which is known as the urban heat island effect. Bees are especially sensitive to temperature because flight, foraging, and survival are all temperature-dependent processes (Hamblin et al. 2018). Extreme weather, especially heat waves, drought, and cold snaps, are becoming more frequent and more intense under climate change, and these events can change bee activity and survival in real time (IPCC 2021). Because bees provide major ecosystem services in both natural and urban landscapes, understanding how extreme events might directly affect bee communities is becoming increasingly important. This is especially relevant in the Pacific Northwest because climate models predict an increase in extreme weather (Oregon Climate Change Research Institute 2023).
Many researchers have looked at how warming affects bees, but most studies focus on general warming trends and not discrete extreme weather events. For example, Hamblin et al. (2018) showed that even small temperature increases in urban areas led to sharp declines in bee abundance, and trait-focused studies have shown that warming selects for heat-tolerant, drought-tolerant species over time (Diamond et al. 2020). Other work has shown that short-term weather like wind, rain, and cold shocks can suppress bee flight and foraging in daily or weekly time scales (Crone & Williams 2016). Together, this past work shows bees respond to temperature both immediately and cumulatively, which sets up a strong connection between bees and extreme weather stressors.
For this project, we will be using two datasets. The first dataset we will be using is the Oregon Bee Atlas dataset which is a community science driven survey program that contains location and species-level information for Oregon bees. The second main dataset we will be using is the NOAA Storm Events Database, which has time-stamped records of heat waves, ice storms, and other extreme weather events. Previous studies usually donâ€™t combine bee data with extreme weather event data sources.  By comparing the bee sampling data with the extreme weather data, we can test for direct impacts following weather events, which is something the literature keeps saying we need more of (Hamblin et al. 2018; Diamond et al. 2020).
Furthermore, the purpose of our study is to explicitly measure how extreme weather events influence bee observations in urban regions of Oregon. We will align bee records with specific storm events within matching time windows and then look for patterns in species diversity, abundance, and trait structure. This matters because Oregon is warming rapidly and extreme weather is becoming more common. By pairing these two databases, we can take a step toward filling the literature gaps in how we interpret bee vulnerability in cities.
Our main hypotheses are:
H1) We predict that extreme weather events will reduce bee diversity in urban areas of Oregon 
H2) We predict that communities will shift toward more generalist species over time
H3) 
If supported, these findings can provide clearer early-warning signals for conservation and urban planning in Oregon, especially for cities trying to maintain pollination services under a future with more extremes.


## Dataset Identification
Dataset 1: National Centers for Environmental Information - Storm Events Database (https://www.ncei.noaa.gov/stormevents/)
This dataset provides an Excel CSV file for different storm events in Oregon, such as droughts and tornadoes. For this project, we will use the "Heat" event type data (instances of heat above 100 degrees) and select only counties in Oregon. Each instance of the data was collected by a different source (listed on the spreadsheet), such as Official NWS Observations, Trained spotters, and county officials. The data includes values for start date, end date, geographic zone, specific temperatures, deaths, and injuries. We will have to manually add a county column extracted from the zone column, in order to join it with our OBA data. I also wanted to add cold events but there is not much data there. 

Dataset 2: National Centers for Environmental Information - Storm Events Database (https://www.ncei.noaa.gov/stormevents/)
Added additional dataset from the same source. This time, I queried for winter weather, winter storm, ice storm, frost/freeze, extreme cold/wind chill, and cold/wind chill. Metadata is the same as dataset 1 for extreme heat. This dataset only has one date, no start and end. This is okay, as we will likely only look at the end date for the heat data anyways. 




## Workflow Plan (review)
Before we join our datasets together, we will have to clean the data. For the OBA dataset, we will want to only keep the columns for specimen, genus, date, county, locality, the coordinate columns, species sex, and the plant genus as well. We don't really have a need to keep the ID columns for example. We will also need to create a new date column that follows the same conventions as the one in the extreme weather dataset. This means using excel functions to figure out if a date in the OBA dataset falls within the begin/end date on the extreme heat dataset. For our extreme heat dataset (Dataset 1), we will want to only keep the relevant columns. This means Removing the columns for zone, event type (All of them are the same since we filtered on the website), deaths, injuries, damage, state, timezone, event ID, and the other identification columns. We pretty much need to just keep the start date, end date, county, and description columns (in case we need to examine specific temperatures). 

Once we clean the data, we can join the OBA data table and the first extreme weather dataset on the County and date columns, since they follow the same naming conventions for each table. It will be an outer join. We will have some null values in the instances of the bees and plants that didn't fall within one of the heatwaves. We will want to compare our data collected outside of the extreme weather, with the data in the extreme weather, to see if the temperature impacted pollination or bee appearances or anything else. 

After joining the data, we will want to figure out a null hypothesis and alternative hypothesis. In this project, these are as follows:

Null: Extreme weather events have no impact on bee's pollination
Alternative: Extreme weather and temperature causes bees to pollinate fewer flowers

Then, we will prepare for AB testing by then shuffling the data, without replacement, on the weather event column. This will randomly assign values of event (ex/, heatwaves or not heatwaves) to the bees. We can then simulate this x number of times, probably 1000 or 10000, to simulate a totally random population null model. We then calculate the p value with math and determine whether or not to reject our null. 






## Partner Contributions


